<template>
  <section class="news_section">
    <HeaderNav />
    <HeaderTitle :title-data="title" :bg-image="bgImage" />
    <div class="title-con">
      <span class="title">í‹°ì•¤í‹° ìŠ¤íŠœë””ì˜¤ {{ rooms[0].title }}</span>
    </div>
    <div class="container">
      <div class="img-con">
        <img :src="rooms[0].imageSrc" class="img" alt="studio" />
        <div class="img-info">
          <p class="img-title">
            í™”ì´íŠ¸ë¡œ ê¾¸ë©°ì§„ ë‹¤ì–‘í•œ ì»¨ì…‰ê³µê°„ [íšŒì‚¬,ë¶€ì—Œ,ê³µë°©,íœ´ì‹]
          </p>
        </div>
        <div class="descript">
          <p class="intro">ì¥ì†Œ ì†Œê°œ</p>
          <br />
          <p>ğŸ¤ ë‹¤ì–‘í•œ ì»¨ì…‰ ê³µê°„</p>
          <p>: ì•½ 100í‰ì˜ ë„“ì€ ê³µê°„ì„</p>
          <p>ê° ì»¨ì…‰ì— ë§ê²Œ ì¸í…Œë¦¬ì–´ í•´ë†“ì•˜ìŠµë‹ˆë‹¤</p>
          <br />
          <p>
            -ì‚¬ë¬´ê³µê°„ (25í‰) : íŠ¸ë Œë””í•œ íšŒì‚¬ë¶„ìœ„ê¸° ì´¬ì˜ì„ ì›í•˜ì‹ ë‹¤ë©´ ì¢‹ì€ ê·¸ë¦¼ì´
            ë‚˜ì˜¬ë§Œí¼ì˜ ë„“ì´ì™€ ë°°ì¹˜ê°€ ë˜ì–´ìˆìŠµë‹ˆë‹¤ ì• ì´ˆì— ê·¸ëŸ° ì›¹ë“œë¼ë§ˆì´¬ì˜ìª½ì„
            ê³ ë ¤í–ˆë˜ ë°°ì¹˜ì…ë‹ˆë‹¤:) ì‹¤ì œ ì‚¬ë¬´ê³µê°„ì—ì„œ ì‘ì—…ì„ í•˜ê³ ìˆê¸°ì— ì†Œí’ˆì´ë‚˜
            ë°°ì¹˜ì˜ í˜„ì¥ê°ë„ ì‚´ì•„ìˆìŠµë‹ˆë‹¤
          </p>
          <p>
            -ê³µë°© (15í‰) : ì•…ì„¸ì„œë¦¬ê³µì˜ˆ,ì¬ë´‰í‹€, ë‹¤ì–‘í•œ ì·¨ë¯¸ ë“±ì˜ ë„êµ¬ë“¤ì´
            êµ¬ë¹„ë˜ìˆìœ¼ë©° ë„êµ¬ ë° ì¥ë¹„/ê³µì˜ˆí’ˆ ì†Œí’ˆìœ¼ë¡œ ëŒ€ì—¬ ê°€ëŠ¥í•©ë‹ˆë‹¤
          </p>
          <p>
            -ë¶€ì—Œ (7í‰) : ë¯¸ë‹ˆì˜¤ë¸,ì „ìë ˆì¸ì§€,ëƒ‰ì¥ê³ , ì•„ì¼ëœë“œì‹íƒ ë“± ê°ì„±ì ì¸
            í™ˆì¹´í˜ ë¸Œì´ë¡œê·¸ë¡œ ì í•©í•œ ì»¨ì…‰ê³µê°„ì…ë‹ˆë‹¤ ì‹¤ì œ ì¡°ë¦¬ë„êµ¬ë“¤ë¡œ ëŒ€ì—¬
            ê°€ëŠ¥í•©ë‹ˆë‹¤
          </p>
        </div>
      </div>
      <div class="info-con">
        <div class="info">
          <div class="title-info">
            <p class="title">{{ rooms[0].title }}</p>
            <p class="price">{{ rooms[0].price.toLocaleString() }}ì›</p>
            <router-link to="/CalendarReservate">
              <v-btn class="title">í‹°í‚¤ì•¤íƒ€ì¹´ ì˜ˆì•½ í˜„í™©</v-btn>
            </router-link>
          </div>
          <hr />
          <div class="schedule-con">
            <p class="title">ìŠ¤ì¼€ì¤„</p>

            <!-- ë‚ ì§œ í…Œì´ë¸” -->
            <!-- <v-text-field
              @click="dialog = !dialog"
              variant="outlined"
              label="ë‚ ì§œë¥¼ ì„ íƒí•´ ì£¼ì„¸ìš”"
              readonly
              class="sub-title"
              v-model="date"
            >
            </v-text-field> -->
            <div class="date-picker">
              <!-- <v-date-picker
                v-if="dialog"
                :min="minDate"
                :max="maxDate"
                v-model="date"
                @update:model-value="updateDate"
                hide-actions
              /> -->
              <Datepicker
                :value="date"
                v-model="date"
                @input="updateDate"
                format="yyyy-MM-dd"
                placeholder="ë‚ ì§œë¥¼ ì„ íƒí•´ ì£¼ì„¸ìš”"
                :disabled-dates="disableDate"
              />
            </div>
            <!-- ì‹œê°„ í…Œì´ë¸” -->
            <div class="time-con" v-if="date">
              <p class="time-title" style="margin-top: 20px">ì‹œê°„</p>
              <p class="sub-title">ìµœì†Œ 3ì‹œê°„ ì´ìƒ</p>
              <v-text-field
                @click="timeDialog = !timeDialog"
                variant="outlined"
                label="ì‹œê°„ì„ ì„ íƒí•´ ì£¼ì„¸ìš”"
                readonly
                class="sub-title"
                v-model="timeString"
              >
                <!-- {{ date }} -->
              </v-text-field>
              <div
                v-if="timeDialog"
                class="time-box"
                style="
                  border: solid 1px rgb(204, 204, 204);
                  padding: 32px;
                  border-radius: 10px;
                "
              >
                <v-btn
                  v-for="i in 24"
                  :key="i"
                  style="margin: 6px"
                  @click="setTime(i)"
                  :class="{
                    'selected-time': isTimeSelected(i),
                    'block-time': BlockTimeSet(i),
                  }"
                >
                  {{ i < 10 ? "0" + i : i }}:00
                </v-btn>
                <div
                  class="time-apply"
                  style="display: flex; justify-content: right; margin: 8px 0px"
                >
                  <v-btn
                    style="margin: 0px 4px"
                    @click="confirmSelectedTime(true)"
                    >í™•ì¸</v-btn
                  >
                  <v-btn style="margin: 0px 4px" @click="cancelSelectedTime"
                    >ì·¨ì†Œ</v-btn
                  >
                </div>
              </div>
            </div>
            <!-- ì¥ë¹„ í…Œì´ë¸” -->
            <div class="equipment-con" v-if="date">
              <p class="equipment-title" style="margin-top: 20px">ì¥ë¹„</p>
              <p class="sub-title">í•„ìš”í•˜ì‹  ì¥ë¹„ë¥¼ ì„ íƒí•´ ì£¼ì„¸ìš”</p>
              <v-row>
                <v-col
                  cols="3"
                  v-for="(item, index) in EquipmentType"
                  :key="index"
                  @click="isEquipmentSelected(index, item[1])"
                >
                  <v-checkbox v-model="item[1]" :label="item[0]"> </v-checkbox>
                </v-col>
              </v-row>
              <div v-for="(item, index) in Equipments" :key="index">
                <div v-if="EquipmentType[index][1]">
                  <p class="sub-title">
                    {{ setEquipmentType(index) }}ë¥¼ ì„ íƒí•´ ì£¼ì„¸ìš”
                  </p>
                  <v-select
                    v-model="Selected[index]"
                    :items="item"
                    :label="setEquipmentType(index) + 'ë¥¼ ì„ íƒí•´ ì£¼ì„¸ìš”'"
                    variant="outlined"
                    multiple
                    @update:model-value="
                      setEquipmentSelected(Selected[index], index)
                    "
                  >
                  </v-select>
                </div>
              </div>
            </div>

            <!-- ì¸ì› í…Œì´ë¸” -->
            <p class="num-title" style="margin-top: 20px">ì´ì¸ì›</p>
            <p class="sub-title">
              ìµœì†Œ ì¸ì› ì´ˆê³¼ì‹œ ì¸ë‹¹
              {{ this.rooms[0].numPrice.toLocaleString() }}ì› ì¶”ê°€ ë¹„ìš© ë°œìƒ
            </p>
            <v-text-field
              label="ì¸ì›ìˆ˜ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”."
              persistent-hint
              variant="outlined"
              class="sub-title"
              v-model="num"
              readonly
            ></v-text-field>
            <div
              class="num-box"
              style="
                display: flex;
                justify-content: space-between;
                align-items: center;
              "
            >
              ì´ì¸ì› ìˆ˜
              <div
                class=""
                style="display: flex; padding: 12px; align-items: center"
              >
                <span
                  class="mdi mdi-minus-circle-outline"
                  style="
                    font-size: 30px;
                    color: rgb(90, 90, 90);
                    cursor: pointer;
                  "
                  @click="minusBtn"
                ></span>

                <div style="margin: 0px 30px; font-size: 16px">
                  {{ num }}
                </div>

                <span
                  class="mdi mdi-plus-circle-outline"
                  style="
                    font-size: 30px;
                    color: rgb(90, 90, 90);
                    cursor: pointer;
                  "
                  @click="plusBtn"
                ></span>
              </div>
            </div>

            <div class="price-con" v-if="timeHour != 0">
              <hr style="margin-bottom: 20px" />
              <div style="display: flex; justify-content: space-between">
                <span
                  >ìŠ¤íŠœë””ì˜¤ {{ this.timeHour }}ì‹œê°„ x
                  {{ rooms[0].price.toLocaleString() }}ì›
                </span>
                <span>
                  {{ (rooms[0].price * this.timeHour).toLocaleString() }}ì›
                </span>
              </div>
              <div style="display: flex; justify-content: space-between">
                <span>
                  ì¸ì›ìˆ˜
                  {{ this.num }}ëª… x {{ rooms[0].numPrice.toLocaleString() }}ì›
                  ( ìµœì†Œ {{ rooms[0].numMin }}ëª… ~ ìµœëŒ€ {{ rooms[0].numMax }}ëª…)
                </span>
                <span> {{ this.numPrice.toLocaleString() }}ì› </span>
              </div>
              <div style="display: flex; justify-content: space-between">
                <span> ì¥ë¹„ ê°€ê²© </span>
                <span> {{ this.equipmentPrice.toLocaleString() }}ì› </span>
              </div>
              <hr style="margin: 20px 0px" />
              <div style="display: flex; justify-content: space-between">
                <span>ì´ ê°€ê²©</span>
                <span>{{ this.totalPrice.toLocaleString() }}ì›</span>
              </div>
            </div>
            <DialogReserve
              :date="date"
              :time-string="timeString"
              :num="num"
              :total-price="totalPrice"
              :time-list="timeList"
              :camera="Selected.camera"
              :monitor="Selected.monitor"
              :micAudio="Selected.micAudio"
              :lightSubFilm="Selected.lightSubFilm"
              :equipmentNum="Selected.equipmentNum"
            />
          </div>
        </div>
      </div>
    </div>
    <Footer />
  </section>
</template>

<script>
import HeaderNav from "@/components/Header/HeaderSub.vue";
import HeaderTitle from "@/components/Header/SubTitle.vue";
import Footer from "@/components/Footer/FooterMain.vue";
import DialogReserve from "./DialogReserve.vue";

import { mapGetters } from "vuex";
import Datepicker from "vuejs3-datepicker";
import $ from "jquery";

export default {
  name: "ReservateDetail1",
  components: {
    HeaderNav,
    Footer,
    HeaderTitle,
    DialogReserve,
    Datepicker,
  },
  computed: {
    ...mapGetters(["rooms", "hostAddressName", "equipments"]),
  },
  data() {
    return {
      title: "ì˜ˆì•½í•˜ê¸°",
      bgImage: [
        require("@/assets/banner/notify1920.svg"),
        require("@/assets/banner/notify1300.svg"),
        require("@/assets/banner/notify760.svg"),
      ],
      studioImage: [require("@/assets/studio/studio3.svg")],
      dialog: false,
      disableDate: {
        to: new Date(),
        from: null,
      },
      date: null,
      timeDialog: false,
      timeList: [],
      timeString: "00:00 - 00:00, 0ì‹œê°„",
      timeHour: 0,
      selectedStartTime: 0,
      selectedEndTime: 0,
      EquipmentType: {
        camera: ["ì¹´ë©”ë¼", false],
        monitor: ["ëª¨ë‹ˆí„°", false],
        micAudio: ["ë§ˆì´í¬&ì˜¤ë””ì˜¤", false],
        lightSubFilm: ["ì¡°ëª…&ì´¬ì˜ë³´ì¡°", false],
      },
      Equipments: {
        camera: [],
        monitor: [],
        micAudio: [],
        lightSubFilm: [],
      },
      Selected: {
        camera: [],
        monitor: [],
        micAudio: [],
        lightSubFilm: [],
        equipmentNum: [],
      },
      camera: [],
      num: 0,
      equipmentPrice: 0,
      numPrice: 0,
      totalPrice: 0,
      blockTimeList: [],
      checkAccount: false,
    };
  },
  mounted() {
    if (this.equipments) {
      for (var i = 0; i < this.equipments.camera.length; i++) {
        this.Equipments.camera.push(this.equipments.camera[i].name);
      }
      for (var k = 0; k < this.equipments.monitor.length; k++) {
        this.Equipments.monitor.push(this.equipments.monitor[k].name);
      }
      for (var m = 0; m < this.equipments.MicAudio.length; m++) {
        this.Equipments.micAudio.push(this.equipments.MicAudio[m].name);
      }
      for (var l = 0; l < this.equipments.LightSubFilm.length; l++) {
        this.Equipments.lightSubFilm.push(this.equipments.LightSubFilm[l].name);
      }
    }
  },
  watch: {
    Selected(newVal, oldVal) {
      console.log(newVal, oldVal);
    },
  },
  methods: {
    setTime(time) {
      // ì²˜ìŒ ì„ íƒ í•  ì‹œ ìë™ 3ì‹œê°„
      if (this.selectedStartTime === 0) {
        this.selectedStartTime = time;
        this.selectedEndTime = time + 3;
      } else {
        this.selectedEndTime = time;
      }
      // ìµœì†Œ ì´ìš©ì‹œê°„ 3ì‹œê°„ìœ¼ë¡œ ì§€ì •
      if (
        this.selectedEndTime > this.selectedStartTime &&
        this.selectedEndTime <= this.selectedStartTime + 3
      ) {
        this.selectedEndTime = this.selectedStartTime + 3;
      }

      // ì‹œì‘ ì‹œê°„ë³´ë‹¤ ì „ ì‹œê°„ì„ ì˜ˆì•½í•˜ë ¤ê³  í• ì‹œì— ì´ˆê¸°í™”
      if (this.selectedEndTime <= this.selectedStartTime) {
        this.selectedStartTime = 0;
        this.selectedEndTime = 0;
      }

      // block ì‹œê°„ì´ ìˆìœ¼ë©´ ì„ íƒ ë¶ˆê°€
      if (
        // blockì‹œê°„ 3ì‹œê°„ ì „ê¹Œì§€ëŠ” ì„ íƒë¶ˆê°€ => ìµœì†Œ ì‹œê°„ 3ì‹œê°„
        this.selectedStartTime >= this.blockTimeList[0] - 3 &&
        this.selectedStartTime <=
          this.blockTimeList[this.blockTimeList.length - 1]
      ) {
        alert("ìµœì†Œ ì´ìš© ì‹œê°„ ë° ì´ìš© ì¤‘ì¸ ì‹œê°„ëŒ€ë¥¼ í™•ì¸í•´ ì£¼ì„¸ìš”.");
        this.selectedStartTime = 0;
        this.selectedEndTime = 0;
      }
      if (
        // blockëœ ì‹œê°„ì—ëŠ” endì„ íƒë¶ˆê°€
        this.selectedEndTime >= this.blockTimeList[0] &&
        this.selectedEndTime <=
          this.blockTimeList[this.blockTimeList.length - 1]
      ) {
        alert("ì´ìš© ì¤‘ì¸ ì‹œê°„ëŒ€ë¥¼ í™•ì¸í•´ ì£¼ì„¸ìš”.");
        this.selectedStartTime = 0;
        this.selectedEndTime = 0;
      }
      if (
        // startê°€ ì¡´ì¬í–ˆì„ì‹œ block ì´í›„ì˜ ì‹œê°„ëŒ€ëŠ” ì„ íƒ ë¶ˆê°€
        this.selectedStartTime <= this.blockTimeList[0] &&
        this.selectedEndTime > this.blockTimeList[0]
      ) {
        alert("ì´ìš© ì¤‘ì¸ ì‹œê°„ëŒ€ë¥¼ í™•ì¸í•´ ì£¼ì„¸ìš”.");
        this.selectedStartTime = 0;
        this.selectedEndTime = 0;
      }
      if (this.selectedStartTime > 21) {
        alert("ìµœì†Œ ì´ìš© ì‹œê°„ì„ í™•ì¸í•´ ì£¼ì„¸ìš”.");
        this.selectedStartTime = 0;
        this.selectedEndTime = 0;
      }
      this.confirmSelectedTime(false);
      console.log("timeList: " + this.timeList);
    },

    // í´ë˜ìŠ¤ ë¶€ì—¬
    isTimeSelected(i) {
      this.timeHour = this.selectedEndTime - this.selectedStartTime;
      this.timeString = `${this.selectedStartTime}:00 - ${this.selectedEndTime}:00 , ${this.timeHour}ì‹œê°„`;

      if (this.selectedStartTime !== 0 && this.selectedEndTime !== 0) {
        return i >= this.selectedStartTime && i <= this.selectedEndTime;
      }
    },
    BlockTimeSet(i) {
      return this.blockTimeList.includes(i);
    },

    // í™•ì¸ ëˆŒë €ì„ì‹œ timeListì— ë°°ì—´ ì €ì¥
    confirmSelectedTime(bool) {
      const hoursDifference = this.selectedEndTime - this.selectedStartTime;
      if (this.timeList.length === 0) {
        for (let i = 0; i <= hoursDifference; i++) {
          const currentHour = this.selectedStartTime + i;
          const formattedTime =
            (currentHour < 10 ? "0" + currentHour : currentHour) + ":00";
          this.timeList.push(formattedTime);
        }
      } else {
        this.timeList = [];
        for (let i = 0; i <= hoursDifference; i++) {
          const currentHour = this.selectedStartTime + i;
          const formattedTime =
            (currentHour < 10 ? "0" + currentHour : currentHour) + ":00";
          this.timeList.push(formattedTime);
        }
      }
      if (bool) {
        this.timeDialog = false;
      }
      console.log("timeList: " + this.timeList);
      this.PriceCalc();
    },

    // ì·¨ì†Œì‹œ ì´ˆê¸°í™”
    cancelSelectedTime() {
      this.timeList = [];
      this.timeString = "00:00 - 00:00, 0ì‹œê°„";
      this.timeHour = 0;
      this.selectedStartTime = 0;
      this.selectedEndTime = 0;
      this.timeDialog = false;
    },

    updateDate(date) {
      if (Array.isArray(date)) {
        date = date[0];
      }
      this.date = this.date.toISOString().slice(0, 10);
      console.log(this.date);
      this.getDisabledate();
      this.getDisableEquipment();
    },

    setEquipmentType(equipment) {
      if (equipment === "camera") {
        return "ì¹´ë©”ë¼";
      }
      if (equipment === "monitor") {
        return "ëª¨ë‹ˆí„°";
      }
      if (equipment === "micAudio") {
        return "ë§ˆì´í¬&ì˜¤ë””ì˜¤";
      }
      if (equipment === "lightSubFilm") {
        return "ì¡°ëª…&ì´¬ì˜ë³´ì¡°";
      }
    },

    // setEquipmentSelected(selectedName) {
    //   const equipmentTypes = ["camera", "monitor", "micAudio", "lightSubFilm"];

    //   equipmentTypes.forEach((type) => {
    //     if (this.equipments[type]) {
    //       this.equipments[type].forEach((equipment) => {
    //         if (selectedName.includes(equipment.name)) {
    //           this.Selected.equipmentNum.push(equipment.equipmentNum);
    //         }
    //       });
    //     }
    //   });

    //   const RemoveDuplicate = [...new Set(this.Selected.equipmentNum)];
    //   this.Selected.equipmentNum = RemoveDuplicate;
    //   console.log(this.Selected.equipmentNum);
    // },

    setEquipmentSelected(selectedName, type) {
      console.log(this.Selected);
      const equipmentMapping = {
        camera: "camera",
        monitor: "monitor",
        micAudio: "MicAudio",
        lightSubFilm: "LightSubFilm",
      };

      const equipmentKey = equipmentMapping[type];

      let removedSelected;

      if (!this.equipments[equipmentKey]) {
        console.warn(`Equipment type "${type}" not found.`);
        return;
      }

      this.equipments[equipmentKey].forEach((equipment) => {
        if (
          selectedName.includes(equipment.name) &&
          !this.Selected.equipmentNum.includes(equipment.equipmentNum)
        ) {
          // ì„ íƒëœ í•­ëª©ì´ this.Selected.equipmentNumì— ì—†ìœ¼ë©´ ì¶”ê°€
          this.Selected.equipmentNum.push(equipment.equipmentNum);
        } else if (
          !selectedName.includes(equipment.name) &&
          this.Selected.equipmentNum.includes(equipment.equipmentNum)
        ) {
          // ì„ íƒ í•´ì œëœ í•­ëª©ì´ this.Selected.equipmentNumì— ìˆìœ¼ë©´ ì œê±°
          this.Selected.equipmentNum = this.Selected.equipmentNum.filter(
            (num) => num !== equipment.equipmentNum
          );
          removedSelected = equipment.equipmentNum;
        }
      });

      this.Selected.equipmentNum = [...new Set(this.Selected.equipmentNum)];
      this.equipmentCalc(removedSelected);
    },

    // ì²´í¬ í•´ì œì‹œ ì´ˆê¸°í™”
    isEquipmentSelected(type, bool) {
      bool = !bool;
      const equipmentNumRange = {
        camera: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 15],
        monitor: [12],
        micAudio: [16, 17, 18, 19, 20],
        lightSubFilm: [21, 22, 23],
      };
      console.log("type : " + type);

      if (bool === false) {
        console.log(equipmentNumRange[type]);
        if (equipmentNumRange[type]) {
          if (type === "micAudio") {
            type = "MicAudio";
          }
          if (type === "lightSubFilm") {
            type = "LightSubFilm";
          }
          // equipmentsì˜ ë‘ë²ˆì§¸ íŒŒë¼ë¯¸í„°ì™€ ê°™ì„ë•Œ
          console.log("selected:" + this.Selected.equipmentNum);

          console.log(this.equipments[type]);
          for (var i = 0; i < this.equipments[type].length; i++) {
            for (var k = 0; k < this.Selected.equipmentNum.length; k++) {
              if (
                this.equipments[type][i].equipmentNum ===
                this.Selected.equipmentNum[k]
              ) {
                this.equipmentPrice -= this.equipments[type][i].price;
                console.log(this.equipments[type][i].price);
              }
            }
          }

          if (type === "MicAudio") {
            type = "micAudio";
          }
          if (type === "LightSubFilm") {
            type = "lightSubFilm";
          }

          this.Selected.equipmentNum = this.Selected.equipmentNum.filter(
            (num) => !equipmentNumRange[type].includes(num)
          );
          this.Selected[type] = [];
          this.PriceCalc();
        }
      }
    },

    minusBtn() {
      this.num--;
      if (this.num <= 0) {
        this.num = 0;
      }
      this.PriceCalc();
    },
    plusBtn() {
      this.num++;
      if (this.num >= this.rooms[0].numMax) {
        this.num = this.rooms[0].numMax;
      }
      this.PriceCalc();
    },

    PriceCalc() {
      this.numPrice =
        this.rooms[0].numPrice * (this.num - this.rooms[0].numMin);
      if (this.num <= this.rooms[0].numMin) {
        this.numPrice = 0;
      }
      console.log(this.numPrice);
      this.totalPrice =
        this.rooms[0].price * this.timeHour +
        this.equipmentPrice +
        this.numPrice;
    },

    equipmentCalc(removedSelected) {
      const equipmentNumRange = {
        camera: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 15],
        monitor: [12],
        micAudio: [16, 17, 18, 19, 20],
        lightSubFilm: [21, 22, 23],
      };

      var equipmentType = "";

      if (this.Selected.equipmentNum.length > 0 && !removedSelected) {
        // ì·¨ì†Œëœ í•­ëª©ì´ ì—†ì„ë•Œ, ê¸°ë³¸ì ìœ¼ë¡œ ë‘ë²ˆì§¸ ë³€ìˆ˜ë¥¼ ì—¬ê¸°ì„œ ë°›ìŒ
        for (var i = 0; i <= this.Selected.equipmentNum.length - 1; i++) {
          let currentNum = this.Selected.equipmentNum[i];
          console.log("equipment: " + this.Selected.equipmentNum[i]);

          let matchedKey = Object.keys(equipmentNumRange).find((key) =>
            equipmentNumRange[key].includes(currentNum)
          );

          if (matchedKey) {
            switch (matchedKey) {
              case "micAudio":
                equipmentType = "MicAudio";
                break;
              case "lightSubFilm":
                equipmentType = "LightSubFilm";
                break;
              default:
                equipmentType = matchedKey;
            }
          }
        }
      } else {
        // ì·¨ì†Œëœ í•­ë³µì´ ìˆì„ë•Œ, ì„ íƒ í•­ëª© ë¦¬ìŠ¤íŠ¸ê°€ ë¹„ì—ˆì„ë•Œ
        let matchedKey = Object.keys(equipmentNumRange).find((key) =>
          equipmentNumRange[key].includes(removedSelected)
        );

        if (matchedKey) {
          switch (matchedKey) {
            case "micAudio":
              equipmentType = "MicAudio";
              break;
            case "lightSubFilm":
              equipmentType = "LightSubFilm";
              break;
            default:
              equipmentType = matchedKey;
          }
        }
      }

      console.log("ì‚­ì œëœ í•­ëª© : " + removedSelected);
      console.log(equipmentType);
      if (this.equipments[equipmentType]) {
        // ë‘ë²ˆì§¸ í•­ëª©ì´ ìˆì„ì‹œì— ê°€ê²© ëŒ€ì… ì‹œí–‰(ì˜¤ë¥˜ë°©ì§€)
        for (var k = 0; k < this.equipments[equipmentType].length; k++) {
          // ì „ì—­ ë³€ìˆ˜ equipments.parameter ë¦¬ìŠ¤íŠ¸ forë¬¸
          let currentNum =
            this.Selected.equipmentNum[this.Selected.equipmentNum.length - 1]; // ì„ íƒí•œ í•­ëª©ì˜ ê°€ì¥ ìµœê·¼ ìˆ«ì
          if (
            // forë¬¸ì„ ëŒë ¤ ê°€ì¥ ìµœê·¼ ìˆ«ìì™€ ì•Œë§ëŠ” price ë°ì´í„° ë½‘ê¸°, ì·¨ì†Œ í•­ëª©ì—†ì„ì‹œì— ì‹œí–‰ (ì´ê¸ˆì•¡ì— í•­ëª© ê°€ê²© ì¶”ê°€)
            this.equipments[equipmentType][k].equipmentNum === currentNum &&
            !removedSelected
          ) {
            var price = this.equipments[equipmentType][k].price;
            this.equipmentPrice += price;
            this.PriceCalc();
            console.log("ì¥ë¹„ " + this.equipments[equipmentType][k].price);
          } else if (removedSelected) {
            // í•­ëª© ì·¨ì†Œí•˜ì˜€ì„ë•Œ ì´ ê¸ˆì•¡ì—ì„œ ì·¨ì†Œí•œ í•­ëª© ê¸ˆì•¡ ê°ì•¡
            if (
              // forë¬¸ ëŒë ¤ ì·¨ì†Œí•œ í•­ëª©ì˜ ê¸ˆì•¡ ê°€ì ¸ì˜¤ê¸°
              this.equipments[equipmentType][k].equipmentNum === removedSelected
            ) {
              this.equipmentPrice -= this.equipments[equipmentType][k].price;
              this.PriceCalc();
              console.log(
                "ì·¨ì†Œ ê°€ê²©" + this.equipments[equipmentType][k].price
              );
            }
          } else {
            // ì·¨ì†Œí•œ í•­ëª©ì´ ë°°ì—´ì˜ ë§ˆì§€ë§‰ ë°ì´í„° ì¼ë•Œ( ì·¨ì†Œí•œ í•­ëª© ê¸ˆì•¡ ì´ê¸ˆì•¡ì—ì„œ ê°ì•¡ ) => ì˜¤ë¥˜ ë°©ì§€ë¥¼ ìœ„í•´ elseì‚¬ìš©
            if (
              this.equipments[equipmentType][k].equipmentNum === removedSelected
            ) {
              this.equipmentPrice -= this.equipments[equipmentType][k].price;
              this.PriceCalc();
              console.log(
                "ë§ˆì§€ë§‰ í•­ëª© ì·¨ì†Œ ê°€ê²©" +
                  this.equipments[equipmentType][k].price
              );
            }
          }
        }
      }

      // removedSelected.forEach((removedNum) => {
      //   Object.keys(this.equipments).forEach((equipType) => {
      //     this.equipments[equipType].forEach((equipment) => {
      //       if (equipment.equipmentNum === removedNum) {
      //         this.equipmentPrice -= equipment.price;
      //         console.log("ì¥ë¹„ ì œê±° " + equipment.price);
      //       }
      //     });
      //   });
      // });

      // for (var a = 0; a < this.equipments[equipmentType].length; a++) {
      //   if (
      //     this.equipments[equipmentType][a].equipmentNum === removedSelected[0]
      //   ) {
      //     this.equipmentPrice -= 2 * this.equipments[equipmentType][a].price;
      //     console.log("ì¥ë¹„ ì·¨ì†Œ" + this.equipments[equipmentType][a].price);
      //   }
      // }
      console.log("ì´ ê°€ê²©" + this.equipmentPrice);
    },

    dateInsert(date) {
      this.blockTimeList = [];
      for (var i = 0; i < date.length; i++) {
        // console.log(date[i].time, date[i].state);
        if (date[i].state == 1) {
          this.blockTimeList.push(parseInt(date[i].time));
        }
      }
    },
    getDisabledate() {
      if (Array.isArray(this.timeList)) {
        var times = this.timeList.map((time) => time.slice(0, 2)).join("");
      }
      console.log(times);
      $.ajax({
        /* ìš”ì²­ ì‹œì‘ ë¶€ë¶„ */
        url:
          this.hostAddressName +
          "/studio/reserve/" +
          this.rooms[0].studioNum +
          "/" +
          this.date +
          "/" +
          times, //ì£¼ì†Œ
        method: "GET",
        type: "get", //ì „ì†¡ íƒ€ì…
        dataType: "json",

        /* ì‘ë‹µ í™•ì¸ ë¶€ë¶„ */
        success: (response) => {
          this.dateInsert(response);
          console.log(response);
        },

        /* ì—ëŸ¬ í™•ì¸ ë¶€ë¶„ */
        error: function (xhr) {
          // alert("ì „ì†¡ ì‹¤íŒ¨");
          console.log("");
          console.log("[serverUploadImage] : [error] : " + xhr);
          console.log("");
        },

        /* ì™„ë£Œ í™•ì¸ ë¶€ë¶„ */
        complete: function (xhr, textStatus) {
          console.log("");
          console.log("[server] : [complete] : " + textStatus);
          console.log("");
        },
      });
    },
    getDisableEquipment() {
      for (var i = 0; i < this.timeList.length; i++) {
        console.log(this.timeList[i]);
      }

      // const timeList = this.timeList.split(",");
      // const times = timeList.map((time) => time.slice(0, 2)).join("");

      $.ajax({
        /* ìš”ì²­ ì‹œì‘ ë¶€ë¶„ */
        url: this.hostAddressName + "/studio/reserve/" + this.date, //ì£¼ì†Œ
        method: "GET",
        type: "get", //ì „ì†¡ íƒ€ì…
        dataType: "json",

        /* ì‘ë‹µ í™•ì¸ ë¶€ë¶„ */
        success: (response) => {
          console.log(response);
        },

        /* ì—ëŸ¬ í™•ì¸ ë¶€ë¶„ */
        error: function (xhr) {
          // alert("ì „ì†¡ ì‹¤íŒ¨");
          console.log("");
          console.log("[serverUploadImage] : [error] : " + xhr);
          console.log("");
        },

        /* ì™„ë£Œ í™•ì¸ ë¶€ë¶„ */
        complete: function (xhr, textStatus) {
          console.log("");
          console.log("[server] : [complete] : " + textStatus);
          console.log("");
        },
      });
    },
  },
};
</script>

<style lang="scss" scoped>
.selected-time {
  background-color: #3399ff;
  color: white;
}
.block-time {
  background-color: #888888; /* Change this to the color you want */
  color: white; /* Change this to the color you want */
}

// ::v-deep .v-picker-title {
//   display: none;
// }
// ::v-deep .v-date-picker-header {
//   display: none;
// }
.news_section {
  .title-con {
    width: 1300px;
    margin: 30px auto;
    .title {
      font-family: "Pretendard-Regular";
      font-weight: bold;
      font-size: 32px;
    }
  }
  .container {
    width: 1300px;
    margin: 0px auto 100px auto;
    display: flex;
    justify-content: space-between;
    .img-con {
      width: calc(60% - 32px);
      .img {
        width: 100%;
        border-radius: 10px;
      }
      font-family: "Pretendard-Regular";
      .img-info {
        .img-title {
          font-weight: bold;
          font-size: 20px;
          padding: 12px;
        }
      }
      .descript {
        padding: 12px;
        font-size: 16px;
        .intro {
          font-weight: bold;
          font-size: 20px;
        }
      }
    }
    .info-con {
      width: calc(40% - 16px);
      .info {
        position: sticky;
        width: 100%;
        padding: 16px;
        border: solid 1px #bebebe;
        border-radius: 10px;
        .title-info {
          font-family: "Pretendard-Regular";
          font-weight: bold;
          font-size: 18px;
          margin: 16px 0px;
        }
        .schedule-con {
          font-family: "Pretendard-Regular";
          font-weight: bold;
          .date-picker {
            display: flex;
            justify-content: center;
            align-items: center;
            ::v-deep .vuejs3-datepicker {
              width: 100% !important;
            }
            ::v-deep .vuejs3-datepicker__value {
              width: 100% !important;
              color: #9e9e9e;
              font-weight: 100;
            }
          }
          .title {
            font-size: 16px;
            margin-top: 20px;
          }
          .sub-title {
            font-size: 12px;
            margin: 10px 0px;
          }
        }
      }
    }
  }
}
</style>
